///**
//  * This file is part of the ONEMA lambda-mailer Package.
//  * For the full copyright and license information,
//  * please view the LICENSE file that was distributed
//  * with this source code.
//  *
//  * copyright (c) 2018, Juan Manuel Torres (http://onema.io)
//  *
//  * @author Juan Manuel Torres <foo@foo.com>
//  */
//import java.io.ByteArrayInputStream
//
//import com.amazonaws.services.s3.AmazonS3
//import com.amazonaws.services.s3.model.S3Object
//import com.amazonaws.services.sns.AmazonSNS
//import io.onema.forwarder.ForwarderLogic
//import io.onema.forwarder.ForwarderLogic.SesMessage
//import io.onema.json.Extensions._
//import org.scalamock.scalatest.MockFactory
//import org.scalatest.{FlatSpec, Matchers}
//
//
//class ForwarderLogicTest extends FlatSpec with Matchers with MockFactory {
//
//  "An valid email" should "forward an SNS notification" in {
//
//    // Arrange
//    val message = """{"notificationType":"Received","mail":{"timestamp":"2018-08-07T20:05:07.491Z","source":"replyto@test.com","messageId":"key","destination":["foo@foo.com"],"headersTruncated":false,"headers":[{"name":"Return-Path","value":"<replyto@test.com>"},{"name":"Received","value":"from sonic302-31.consmr.mail.bf2.yahoo.com (sonic302-31.consmr.mail.bf2.yahoo.com [74.6.135.230]) by inbound-smtp.us-east-1.amazonaws.com with SMTP id peln35k65ghljnavl0m8hdlbq0omhsm7ti51g9g1 for foo@foo.com; Tue, 07 Aug 2018 20:05:07 +0000 (UTC)"},{"name":"Content-Length","value":"1711"}],"commonHeaders":{"returnPath":"replyto@test.com","from":["Juan Torres <replyto@test.com>"],"date":"Tue, 7 Aug 2018 20:01:06 +0000 (UTC)","to":["\"foo@foo.com\" <foo@foo.com>"],"messageId":"<176128054.3622731.1533672066691@mail.yahoo.com>","subject":"test all things"}},"receipt":{"timestamp":"2018-08-07T20:05:07.491Z","processingTimeMillis":406,"recipients":["foo@foo.com"],"spamVerdict":{"status":"PASS"},"virusVerdict":{"status":"PASS"},"spfVerdict":{"status":"PASS"},"dkimVerdict":{"status":"PROCESSING_FAILED"},"dmarcVerdict":{"status":"PASS"},"action":{"type":"SNS","functionArn":"arn:aws:sns:us-east-1:065150860170:dev-mail-forwarder","encoding":"UTF8"}}}"""
//    val content = "Return-Path: <replyto@test.com>\r\nReceived: from sonic302-31.consmr.mail.bf2.yahoo.com (sonic302-31.consmr.mail.bf2.yahoo.com [74.6.135.230])\r\n by inbound-smtp.us-east-1.amazonaws.com with SMTP id peln35k65ghljnavl0m8hdlbq0omhsm7ti51g9g1\r\n for foo@foo.com;\r\n Tue, 07 Aug 2018 20:05:07 +0000 (UTC)\r\nX-SES-Spam-Verdict: PASS\r\nX-SES-Virus-Verdict: PASS\r\nReceived-SPF: pass (spfCheck: domain of _spf.mail.yahoo.com designates 74.6.135.230 as permitted sender) client-ip=74.6.135.230; envelope-from=replyto@test.com; helo=sonic302-31.consmr.mail.bf2.yahoo.com;\r\nAuthentication-Results: amazonses.com;\r\n spf=pass (spfCheck: domain of _spf.mail.yahoo.com designates 74.6.135.230 as permitted sender) client-ip=74.6.135.230; envelope-from=replyto@test.com; helo=sonic302-31.consmr.mail.bf2.yahoo.com;\r\n dkim=permerror header.i=@ymail.com;\r\nFrom: Juan Torres <replyto@test.com>\r\nTo: \"foo@foo.com\" <foo@foo.com>\r\nMessage-ID: <176128054.3622731.1533672066691@mail.yahoo.com>\r\nSubject: test all things\r\nMIME-Version: 1.0\r\nContent-Type: multipart/alternative; \r\n\tboundary=\"----=_Part_3622730_1056715004.1533672066689\"\r\nReferences: <176128054.3622731.1533672066691.ref@mail.yahoo.com>\r\nX-Mailer: WebService/1.1.12206 YMailNorrin Mozilla/5.0 (Macintosh; Intel Mac OS X 10_13_6) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/68.0.3440.84 Safari/537.36\r\nContent-Length: 1711\r\n\r\n------=_Part_3622730_1056715004.1533672066689\r\nContent-Type: text/plain; charset=UTF-8\r\nContent-Transfer-Encoding: quoted-printable\r\n\r\nFooBarbazbax=C2=A0 =C2=A0=C2=A0\r\n\r\nHeading\r\nImage\r\n  Via =20\r\n"
//    val expectedRequest = """{"to":["bar@bar.com"],"from":"foo@foo.com","subject":"test all things","body":"Return-Path: foo@foo.com\r\nReceived: from sonic302-31.consmr.mail.bf2.yahoo.com (sonic302-31.consmr.mail.bf2.yahoo.com [74.6.135.230])\r\n by inbound-smtp.us-east-1.amazonaws.com with SMTP id peln35k65ghljnavl0m8hdlbq0omhsm7ti51g9g1\r\n for foo@foo.com;\r\n Tue, 07 Aug 2018 20:05:07 +0000 (UTC)\r\nX-SES-Spam-Verdict: PASS\r\nX-SES-Virus-Verdict: PASS\r\nReceived-SPF: pass (spfCheck: domain of _spf.mail.yahoo.com designates 74.6.135.230 as permitted sender) client-ip=74.6.135.230; envelope-from=replyto@test.com; helo=sonic302-31.consmr.mail.bf2.yahoo.com;\r\nAuthentication-Results: amazonses.com;\r\n spf=pass (spfCheck: domain of _spf.mail.yahoo.com designates 74.6.135.230 as permitted sender) client-ip=74.6.135.230; envelope-from=replyto@test.com; helo=sonic302-31.consmr.mail.bf2.yahoo.com;\r\n dkim=permerror header.i=@ymail.com;\r\nFrom: foo@foo.com\r\nTo: bar@bar.com\r\nMessage-ID: <176128054.3622731.1533672066691@mail.yahoo.com>\r\nSubject: test all things\r\nMIME-Version: 1.0\r\nContent-Type: multipart/alternative; \r\n\tboundary=\"----=_Part_3622730_1056715004.1533672066689\"\r\nReferences: <176128054.3622731.1533672066691.ref@mail.yahoo.com>\r\nX-Mailer: WebService/1.1.12206 YMailNorrin Mozilla/5.0 (Macintosh; Intel Mac OS X 10_13_6) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/68.0.3440.84 Safari/537.36\r\nContent-Length: 1711\r\nReply-To: Juan Torres <replyto@test.com>\r\nSender: foo@foo.com\r\n\r\n------=_Part_3622730_1056715004.1533672066689\r\nContent-Type: text/plain; charset=UTF-8\r\nContent-Transfer-Encoding: quoted-printable\r\n\r\nFooBarbazbax=C2=A0 =C2=A0=C2=A0\r\n\r\nHeading\r\nImage\r\n  Via =20\r\n","replyTo":"","raw":true}"""
//    val emailMapping = "foo@foo.com=bar@bar.com"
//    val s3Mock = s3ClientMock(content)
//    val clientMock = mock[AmazonSNS]
//    (clientMock.publish(_: String, _: String)).expects("some_topic", expectedRequest)
//    val logic = new ForwarderLogic(snsClient = clientMock, mailerTopic = "some_topic", s3Mock, "bucket")
//
//    // Act
//    val sesMessage = message.jsonDecode[SesMessage](ForwarderLogic.fieldRenames)
//
//    // Assert
//    logic.handleRequest(sesMessage, emailMapping)
//  }
//
//  "An Email not in the email mapping" should "generate an exception" in {
//
//    // Arrange
//    val message = "{\"notificationType\":\"Received\",\"mail\":{\"timestamp\":\"2018-08-07T20:05:07.491Z\",\"source\":\"replyto@test.com\",\"messageId\":\"peln35k65ghljnavl0m8hdlbq0omhsm7ti51g9g1\",\"destination\":[\"foo@foo.com\"],\"headersTruncated\":false,\"headers\":[{\"name\":\"Return-Path\",\"value\":\"<replyto@test.com>\"},{\"name\":\"Received\",\"value\":\"from sonic302-31.consmr.mail.bf2.yahoo.com (sonic302-31.consmr.mail.bf2.yahoo.com [74.6.135.230]) by inbound-smtp.us-east-1.amazonaws.com with SMTP id peln35k65ghljnavl0m8hdlbq0omhsm7ti51g9g1 for foo@foo.com; Tue, 07 Aug 2018 20:05:07 +0000 (UTC)\"},{\"name\":\"Content-Length\",\"value\":\"1711\"}],\"commonHeaders\":{\"returnPath\":\"replyto@test.com\",\"from\":[\"Juan Torres <replyto@test.com>\"],\"date\":\"Tue, 7 Aug 2018 20:01:06 +0000 (UTC)\",\"to\":[\"\\\"foo@foo.com\\\" <foo@foo.com>\"],\"messageId\":\"<176128054.3622731.1533672066691@mail.yahoo.com>\",\"subject\":\"test all things\"}},\"receipt\":{\"timestamp\":\"2018-08-07T20:05:07.491Z\",\"processingTimeMillis\":406,\"recipients\":[\"foo@foo.com\"],\"spamVerdict\":{\"status\":\"PASS\"},\"virusVerdict\":{\"status\":\"PASS\"},\"spfVerdict\":{\"status\":\"PASS\"},\"dkimVerdict\":{\"status\":\"PROCESSING_FAILED\"},\"dmarcVerdict\":{\"status\":\"PASS\"},\"action\":{\"type\":\"SNS\",\"functionArn\":\"arn:aws:sns:us-east-1:065150860170:dev-mail-forwarder\",\"encoding\":\"UTF8\"}}}"
//    val content = "Return-Path: <replyto@test.com>\r\nReceived: from sonic302-31.consmr.mail.bf2.yahoo.com (sonic302-31.consmr.mail.bf2.yahoo.com [74.6.135.230])\r\n by inbound-smtp.us-east-1.amazonaws.com with SMTP id peln35k65ghljnavl0m8hdlbq0omhsm7ti51g9g1\r\n for foo@foo.com;\r\n Tue, 07 Aug 2018 20:05:07 +0000 (UTC)\r\nX-SES-Spam-Verdict: PASS\r\nX-SES-Virus-Verdict: PASS\r\nReceived-SPF: pass (spfCheck: domain of _spf.mail.yahoo.com designates 74.6.135.230 as permitted sender) client-ip=74.6.135.230; envelope-from=replyto@test.com; helo=sonic302-31.consmr.mail.bf2.yahoo.com;\r\nAuthentication-Results: amazonses.com;\r\n spf=pass (spfCheck: domain of _spf.mail.yahoo.com designates 74.6.135.230 as permitted sender) client-ip=74.6.135.230; envelope-from=replyto@test.com; helo=sonic302-31.consmr.mail.bf2.yahoo.com;\r\n dkim=permerror header.i=@ymail.com;\r\nFrom: Juan Torres <replyto@test.com>\r\nTo: \"foo@foo.com\" <foo@foo.com>\r\nMessage-ID: <176128054.3622731.1533672066691@mail.yahoo.com>\r\nSubject: test all things\r\nMIME-Version: 1.0\r\nContent-Type: multipart/alternative; \r\n\tboundary=\"----=_Part_3622730_1056715004.1533672066689\"\r\nReferences: <176128054.3622731.1533672066691.ref@mail.yahoo.com>\r\nX-Mailer: WebService/1.1.12206 YMailNorrin Mozilla/5.0 (Macintosh; Intel Mac OS X 10_13_6) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/68.0.3440.84 Safari/537.36\r\nContent-Length: 1711\r\n\r\n------=_Part_3622730_1056715004.1533672066689\r\nContent-Type: text/plain; charset=UTF-8\r\nContent-Transfer-Encoding: quoted-printable\r\n\r\nFooBarbazbax=C2=A0 =C2=A0=C2=A0\r\n\r\nHeading\r\nImage\r\n  Via =20\r\n"
//    val emailMapping = "different@email.com=bar@bar.com"
//    val s3Mock = mock[AmazonS3]
//    val clientMock = mock[AmazonSNS]
//    val logic = new ForwarderLogic(snsClient = clientMock, mailerTopic = "some_topic", s3Mock, "bucket")
//
//    // Act - Assert
//    val sesMessage = message.jsonDecode[SesMessage](ForwarderLogic.fieldRenames)
//    intercept[Exception] { logic.handleRequest(sesMessage, emailMapping) }
//  }
//
//  "An Email with a Return-path different from the original email address" should "properly replace the Return-path" in {
//    val message = """{"notificationType":"Received","mail":{"timestamp":"2018-08-09T00:54:08.973Z","source":"bounces+7617708-766b-foobar=mailer.opsdeploy.com@em2401.lastweekinaws.com","messageId":"key","destination":["foobar@mailer.opsdeploy.com"],"headersTruncated":false,"headers":[{"name":"Return-Path","value":"<bounces+7617708-766b-foobar=mailer.opsdeploy.com@em2401.lastweekinaws.com>"},{"name":"Received","value":"from o1.email.lastweekinaws.com (o1.email.lastweekinaws.com [167.89.87.215]) by inbound-smtp.us-east-1.amazonaws.com with SMTP id qig1onhvj02tunba33p9g6ul96kf2ok4kunjq0o1 for foobar@mailer.opsdeploy.com; Thu, 09 Aug 2018 00:54:08 +0000 (UTC)"},{"name":"X-SES-Spam-Verdict","value":"PASS"},{"name":"X-SES-Virus-Verdict","value":"PASS"},{"name":"Received-SPF","value":"pass (spfCheck: domain of em2401.lastweekinaws.com designates 167.89.87.215 as permitted sender) client-ip=167.89.87.215; envelope-from=bounces+7617708-766b-foobar=mailer.opsdeploy.com@em2401.lastweekinaws.com; helo=o1.email.lastweekinaws.com;"},{"name":"Authentication-Results","value":"amazonses.com; spf=pass (spfCheck: domain of em2401.lastweekinaws.com designates 167.89.87.215 as permitted sender) client-ip=167.89.87.215; envelope-from=bounces+7617708-766b-foobar=mailer.opsdeploy.com@em2401.lastweekinaws.com; helo=o1.email.lastweekinaws.com; dkim=pass header.i=@lastweekinaws.com;"},{"name":"X-SES-RECEIPT","value":"AEFBQUFBQUFBQUFIT3FLb2hNR09CZmhyU3J3Z3poL0ZxR3M1YitQeFByOEFta1IzZ0tjRkZnL0kzbzJ6L1dZOHpaTno5R0prQ2xjOW9LZElTQWxnRi9LdXlLN0xURXFIeXVaVG1VeVdMSTV1cDFhcTRyL0VPRDI4UWIwS2ZzSU5kMGRBVU9EU09HRENsSDhTK25hZEFBeEpvcGQwOEtKTlpZbjdDYmxtaCtIWWRGSXpBMktyRVJwSmtsQnQ1NU53MmZNNjNkUzgvYktwenhlUmVaZFdnc1lEZlkrRWxPQWJjOTBYUWhLbWtIUEhRdHFsNEtrZU10MWNyU29ZcitQWXhwemF4Qnl1ZGhBc1B4RWRjTXN0SmtHMUpJT3Q2eHF1VXJtT0lKbzI1NFRQUko3b3JwOCtnQlJkOUN3WmlNZGc4bkpRMVo1Y2tzVFpUMFpQNmZZYjlFTXhXTXorbUlKS3gwT0RSdFdwS3d5NHlFbU5pNlRzZ2tnPT0="},{"name":"X-SES-DKIM-SIGNATURE","value":"a=rsa-sha256; q=dns/txt; b=YSuSA4tvRFxY9jVt0TuvBz30Goy/JeEdfcL9qfjW/XHXxLuPMrGFq8GD/tl8vKuQkq50CirZNrpwIZs/YXd9jtTS7MoZJ93f6vLmGMShwRYfvX+XtbHW7eE2jkFEmniQfCd3mavkAtzCRxiIN9bzViODhfen60gLznRo+7cMLic=; c=relaxed/simple; s=ug7nbtf4gccmlpwj322ax3p6ow6yfsug; d=amazonses.com; t=1533776049; v=1; bh=aovFYF7sHL5QmVFq8WFGEwzLcXQp3HTm26JbefbHXVg=; h=From:To:Cc:Bcc:Subject:Date:Message-ID:MIME-Version:Content-Type:X-SES-RECEIPT;"},{"name":"DKIM-Signature","value":"v=1; a=rsa-sha1; c=relaxed/relaxed; d=lastweekinaws.com; h=content-type:from:mime-version:to:subject:list-unsubscribe; s=s1; bh=ZWNXoTFM27hXt3NiLd6PY2Gjd9E=; b=ggw0RQdUJXDm+L/GaCb2CKuzS/mI6IRoKr3UTA9fLF5UhgwjKd9NwNKQ1bEYpmuFNmbrsC+q5gn4x2+j5jWc636OSmQuLScizHC6Qzq7XlCMx28yg3ftV/GmilwmRaNLzdpklp9WFSd9vFdhVmjlL/raqBy10iwEdQvRRr0+ZnY="},{"name":"Received","value":"by filter0080p3mdw1.sendgrid.net with SMTP id filter0080p3mdw1-16807-5B6B90B0-1A 2018-08-09 00:54:08.372433409 +0000 UTC m=+102000.921312404"},{"name":"Received","value":"from NzYxNzcwOA (ec2-54-187-77-36.us-west-2.compute.amazonaws.com [54.187.77.36]) by ismtpd0012p1las1.sendgrid.net (SG) with HTTP id D08eQjnLTVeSIpSO1JYmqw Thu, 09 Aug 2018 00:54:08.333 +0000 (UTC)"},{"name":"Content-Type","value":"multipart/alternative; boundary=482ea0e4fea72a1e6563394d91f0759756646a8aaf95e798b65917980f4e"},{"name":"Date","value":"Thu, 09 Aug 2018 00:54:08 +0000 (UTC)"},{"name":"From","value":"\"Corey Quinn\" <corey@lastweekinaws.com>"},{"name":"Mime-Version","value":"1.0"},{"name":"To","value":"foobar@mailer.opsdeploy.com"},{"name":"Message-ID","value":"<D08eQjnLTVeSIpSO1JYmqw@ismtpd0012p1las1.sendgrid.net>"},{"name":"Subject","value":"Please confirm your subscription to Last Week in AWS"},{"name":"X-SG-EID","value":"5DxuPoevWKYjBH+OE0L7SABM8d4rwiV2A634FFGX1dgVFkC4mzUCTLZbCsw6zgIvbia7/bzS0rV87T pMIadss6DvRv9GGlnlkctqv14rbXumV0dt8yhMiquCvQJ6x7bKQK7ElX12S1KqV+5xrfhWtenVeMc2 YlEIdCOM1TYtooEWMbZM48x4f/aGLCP1JhU0g/jcsY1jhLJXBYMp0MYPj+A16tLFRlMcKbsPPxhoJj GARfgb9VLKOXnASyCd9ZMg"},{"name":"List-Unsubscribe","value":"<mailto:unsubscribe@em2401.lastweekinaws.com?subject=https://links.lastweekinaws.com/wf/unsubscribe*q*upn=XwUfvOvxkJcP-2B2a1h27S5NuILQl2Kg6kQrqw-2BRLhkGIPetytAm-2BOmv8MLHrP4d0EiC2-2F0qoc4D1el4IDuUPz4-2FsPvEaC7Qemci7RFWyQeF-2B9XLcc9NFqzmcayIMzQJFsUttO-2BabncfOfSEY8n4L-2Bec9YXn-2FcCuVZ8dmZ2Lbfh4PKdvvVYRl79oQ5vJV-2FUQXM7vXXUoeaXmSzpgmZU0PJR1CNMUfKg0LBxuH5BUhCIJs-3D>"}],"commonHeaders":{"returnPath":"bounces+7617708-766b-foobar=mailer.opsdeploy.com@em2401.lastweekinaws.com","from":["Corey Quinn <corey@lastweekinaws.com>"],"date":"Thu, 09 Aug 2018 00:54:08 +0000 (UTC)","to":["foobar@mailer.opsdeploy.com"],"messageId":"<D08eQjnLTVeSIpSO1JYmqw@ismtpd0012p1las1.sendgrid.net>","subject":"Please confirm your subscription to Last Week in AWS"}},"receipt":{"timestamp":"2018-08-09T00:54:08.973Z","processingTimeMillis":647,"recipients":["foobar@mailer.opsdeploy.com"],"spamVerdict":{"status":"PASS"},"virusVerdict":{"status":"PASS"},"spfVerdict":{"status":"PASS"},"dkimVerdict":{"status":"PASS"},"dmarcVerdict":{"status":"PASS"},"action":{"type":"SNS","functionArn":"arn:aws:sns:us-east-1:065150860170:dev-mail-forwarder","encoding":"UTF8"}}}"""
//    val content = "Return-Path: <bounces+7617708-766b-foobar=mailer.opsdeploy.com@em2401.lastweekinaws.com>\r\nReceived: from o1.email.lastweekinaws.com (o1.email.lastweekinaws.com [167.89.87.215])\r\n by inbound-smtp.us-east-1.amazonaws.com with SMTP id qig1onhvj02tunba33p9g6ul96kf2ok4kunjq0o1\r\n for foobar@mailer.opsdeploy.com;\r\n Thu, 09 Aug 2018 00:54:08 +0000 (UTC)\r\nX-SES-Spam-Verdict: PASS\r\nX-SES-Virus-Verdict: PASS\r\nReceived-SPF: pass (spfCheck: domain of em2401.lastweekinaws.com designates 167.89.87.215 as permitted sender) client-ip=167.89.87.215; envelope-from=bounces+7617708-766b-foobar=mailer.opsdeploy.com@em2401.lastweekinaws.com; helo=o1.email.lastweekinaws.com;\r\nAuthentication-Results: amazonses.com;\r\n spf=pass (spfCheck: domain of em2401.lastweekinaws.com designates 167.89.87.215 as permitted sender) client-ip=167.89.87.215; envelope-from=bounces+7617708-766b-foobar=mailer.opsdeploy.com@em2401.lastweekinaws.com; helo=o1.email.lastweekinaws.com;\r\n dkim=pass header.i=@lastweekinaws.com;\r\nX-SES-RECEIPT: AEFBQUFBQUFBQUFIT3FLb2hNR09CZmhyU3J3Z3poL0ZxR3M1YitQeFByOEFta1IzZ0tjRkZnL0kzbzJ6L1dZOHpaTno5R0prQ2xjOW9LZElTQWxnRi9LdXlLN0xURXFIeXVaVG1VeVdMSTV1cDFhcTRyL0VPRDI4UWIwS2ZzSU5kMGRBVU9EU09HRENsSDhTK25hZEFBeEpvcGQwOEtKTlpZbjdDYmxtaCtIWWRGSXpBMktyRVJwSmtsQnQ1NU53MmZNNjNkUzgvYktwenhlUmVaZFdnc1lEZlkrRWxPQWJjOTBYUWhLbWtIUEhRdHFsNEtrZU10MWNyU29ZcitQWXhwemF4Qnl1ZGhBc1B4RWRjTXN0SmtHMUpJT3Q2eHF1VXJtT0lKbzI1NFRQUko3b3JwOCtnQlJkOUN3WmlNZGc4bkpRMVo1Y2tzVFpUMFpQNmZZYjlFTXhXTXorbUlKS3gwT0RSdFdwS3d5NHlFbU5pNlRzZ2tnPT0=\r\nX-SES-DKIM-SIGNATURE: a=rsa-sha256; q=dns/txt; b=YSuSA4tvRFxY9jVt0TuvBz30Goy/JeEdfcL9qfjW/XHXxLuPMrGFq8GD/tl8vKuQkq50CirZNrpwIZs/YXd9jtTS7MoZJ93f6vLmGMShwRYfvX+XtbHW7eE2jkFEmniQfCd3mavkAtzCRxiIN9bzViODhfen60gLznRo+7cMLic=; c=relaxed/simple; s=ug7nbtf4gccmlpwj322ax3p6ow6yfsug; d=amazonses.com; t=1533776049; v=1; bh=aovFYF7sHL5QmVFq8WFGEwzLcXQp3HTm26JbefbHXVg=; h=From:To:Cc:Bcc:Subject:Date:Message-ID:MIME-Version:Content-Type:X-SES-RECEIPT;\r\nDKIM-Signature: v=1; a=rsa-sha1; c=relaxed/relaxed; \r\n\td=lastweekinaws.com; \r\n\th=content-type:from:mime-version:to:subject:list-unsubscribe; \r\n\ts=s1; bh=ZWNXoTFM27hXt3NiLd6PY2Gjd9E=; b=ggw0RQdUJXDm+L/GaCb2CKu\r\n\tzS/mI6IRoKr3UTA9fLF5UhgwjKd9NwNKQ1bEYpmuFNmbrsC+q5gn4x2+j5jWc636\r\n\tOSmQuLScizHC6Qzq7XlCMx28yg3ftV/GmilwmRaNLzdpklp9WFSd9vFdhVmjlL/r\r\n\taqBy10iwEdQvRRr0+ZnY=\r\nReceived: by filter0080p3mdw1.sendgrid.net with SMTP id filter0080p3mdw1-16807-5B6B90B0-1A\r\n        2018-08-09 00:54:08.372433409 +0000 UTC m=+102000.921312404\r\nReceived: from NzYxNzcwOA (ec2-54-187-77-36.us-west-2.compute.amazonaws.com [54.187.77.36])\r\n\tby ismtpd0012p1las1.sendgrid.net (SG) with HTTP id D08eQjnLTVeSIpSO1JYmqw\r\n\tThu, 09 Aug 2018 00:54:08.333 +0000 (UTC)\r\nContent-Type: multipart/alternative; boundary=482ea0e4fea72a1e6563394d91f0759756646a8aaf95e798b65917980f4e\r\nDate: Thu, 09 Aug 2018 00:54:08 +0000 (UTC)\r\nFrom: \"Corey Quinn\" <corey@lastweekinaws.com>\r\nMime-Version: 1.0\r\nTo: foobar@mailer.opsdeploy.com\r\nMessage-ID: <D08eQjnLTVeSIpSO1JYmqw@ismtpd0012p1las1.sendgrid.net>\r\nSubject: Please confirm your subscription to Last Week in AWS\r\nX-SG-EID: 5DxuPoevWKYjBH+OE0L7SABM8d4rwiV2A634FFGX1dgVFkC4mzUCTLZbCsw6zgIvbia7/bzS0rV87T\r\n pMIadss6DvRv9GGlnlkctqv14rbXumV0dt8yhMiquCvQJ6x7bKQK7ElX12S1KqV+5xrfhWtenVeMc2\r\n YlEIdCOM1TYtooEWMbZM48x4f/aGLCP1JhU0g/jcsY1jhLJXBYMp0MYPj+A16tLFRlMcKbsPPxhoJj\r\n GARfgb9VLKOXnASyCd9ZMg\r\nList-Unsubscribe: <mailto:unsubscribe@em2401.lastweekinaws.com?subject=https://links.lastweekinaws.com/wf/unsubscribe*q*upn=XwUfvOvxkJcP-2B2a1h27S5NuILQl2Kg6kQrqw-2BRLhkGIPetytAm-2BOmv8MLHrP4d0EiC2-2F0qoc4D1el4IDuUPz4-2FsPvEaC7Qemci7RFWyQeF-2B9XLcc9NFqzmcayIMzQJFsUttO-2BabncfOfSEY8n4L-2Bec9YXn-2FcCuVZ8dmZ2Lbfh4PKdvvVYRl79oQ5vJV-2FUQXM7vXXUoeaXmSzpgmZU0PJR1CNMUfKg0LBxuH5BUhCIJs-3D>\r\n\r\n--482ea0e4fea72a1e6563394d91f0759756646a8aaf95e798b65917980f4e\r\ncontent-transfer-encoding: quoted-printable\r\ncontent-type: text/plain; charset=\"UTF-8\"\r\nMime-Version: 1.0\r\n\r\nIf you don't click this link, you receive no AWS snark.\r\n\r\nwww.zombo.com https://links.lastweekinaws.com/wf/click?upn=3DjR4Up5cZVfSvR0=\r\nGQUjisNJiz3S-2BEhD8v3nweTma-2FeAaFhzheviEECOk8KyNNUMGqUcpVRS1AfzLGD4ZQsJbZ2=\r\n81oKMAvmGLxUKIHqGhY2tEI3UrbXYuuNHzwG59R9-2F6tOEGSP-2FuxjnqTLe5vCWXUDA-3D-3D=\r\n_XwUfvOvxkJcP-2B2a1h27S5NuILQl2Kg6kQrqw-2BRLhkGIPetytAm-2BOmv8MLHrP4d0EiC2-=\r\n2F0qoc4D1el4IDuUPz4-2BimtHxZvlB876AvPhmM05qd4nOupH-2FVsAT7gYmCmBm7NtmsWGggP=\r\nXgJDJhbT6DI8y4eE4u8g6Dhhvw0pjjXMqxPXtqizaBT5AUESXD-2B9hHq7M58RCO7JKVXBfEZMd=\r\nsr00apILiaspArTUqGkCLVQRs-3D\r\n\r\nPlease confirm your Last Week in AWS subscription by clicking the link belo=\r\nw:\r\n\r\nConfirm Subscription https://links.lastweekinaws.com/wf/click?upn=3DhvM7RXo=\r\nxZ2y0sN3anKzguOdpVZrLMJgbSh0oE9rIUt0cM07-2B2Kpc-2BNROmlCNnoPUwPeUDLDCV-2Be8=\r\nx9IJ6vMToWAOHPQafvUkiDNQINpcuDlOEIA73rCT22njakO9cttebajyeBMhIV93A4zF89Xrbff=\r\n50-2BRtPxYzfOpzFzFQC15XjED4INEgj3gfx0h0dumhKncUJyOuHbMHbR7jPFH-2F0gYROR2XsN=\r\n8Ic9oNXt7Zs-2BM-2BM4t16g352jxogwpmwFgOFAF-2Fymdq-2FkI2zbKugAsdWL3TKVbnvmEt2=\r\n6HgVPALu5WFjVbbYrf-2FCTARekcrY4qwFlkaZvUlEYMwr6HtEeCEWV6z8LT3z5JChfuI2OiGQy=\r\n5VdFTRXKx-2BQ0u5qQzKH-2FUPJgYdYsW-2BlkxvFCcI-2Br6-2Bu-2Fie-2FUs2ns82WFoYfxn=\r\nCyzkZ-2BUSrOD64njngl7PMUCW06QiKCQdDyMzm9d1lyBFHbACPxSHF-2FMonoO6KFVU4X1Rkqj=\r\nT9qWKWksBdR8jedJqyZQtnFxR845hVGK-2BZkjz6lQ-3D-3D_XwUfvOvxkJcP-2B2a1h27S5NuI=\r\nLQl2Kg6kQrqw-2BRLhkGIPetytAm-2BOmv8MLHrP4d0EiC2-2F0qoc4D1el4IDuUPz49RxIO-2B=\r\ncMXeyBQuvGZiLhDFquSLwbeOWedf2AUmiUloAe-2BTZx5ta-2FVk1fliPnNt0oJFt8KbWlx3lvY=\r\nVTCurog26waxQvzr-2F4aLEk68xsQUCWOgcs9f-2BvX9wldPo6DhuIHTNs4gEMWF4qZzeX-2BnP=\r\nmmfI-3D\r\n\r\nIf you don't want to subscribe, please ignore this email.To make sure you k=\r\neep getting these emails, please add corey@lastweekinaws.com to your addres=\r\ns book or whitelist us. Want out of the loop? https://links.lastweekinaws.c=\r\nom/wf/unsubscribe?upn=3DXwUfvOvxkJcP-2B2a1h27S5NuILQl2Kg6kQrqw-2BRLhkGIPety=\r\ntAm-2BOmv8MLHrP4d0EiC2-2F0qoc4D1el4IDuUPz44Ry1pDrFvBNQCeuEwFKuiBNE2RDVaPax8=\r\n7de3ujhdzoMXtK3DY9XNeKpOcGzwBLFf6iik-2Bsgg2Pyzq1ctS9dhqZdH7TifxZ1UuaUJ5vmT4=\r\n1VyY-2F2RD2VmARnnnME8wgxH4PEqHvR1fAivraS5pMwSo-3D=20\r\n\r\nMy postal address: 1728 Ocean Ave #307, San Francisco, CA 94112\r\n\r\n\r\n--482ea0e4fea72a1e6563394d91f0759756646a8aaf95e798b65917980f4e\r\ncontent-transfer-encoding: quoted-printable\r\ncontent-type: text/html; charset=\"UTF-8\"\r\nMime-Version: 1.0\r\n\r\n<!DOCTYPE html PUBLIC \"-//W3C//DTD XHTML 1.0 Strict//EN\" \"http://www.w3.org=\r\n/TR/xhtml1/DTD/xhtml1-strict.dtd\">\r\n<html data-editor-version=3D\"2\" class=3D\"sg-campaigns\" xmlns=3D\"http://www.=\r\nw3.org/1999/xhtml\">\r\n  <head>\r\n    <meta http-equiv=3D\"Content-Type\" content=3D\"text/html; charset=3Dutf-8=\r\n\" />\r\n    <meta name=3D\"viewport\" content=3D\"width=3Ddevice-width, initial-scale=\r\n=3D1, minimum-scale=3D1, maximum-scale=3D1\" /><!--[if !mso]><!-->\r\n    <meta http-equiv=3D\"X-UA-Compatible\" content=3D\"IE=3DEdge\" /><!--<![end=\r\nif]-->\r\n    <!--[if (gte mso 9)|(IE)]>\r\n    <xml>\r\n    <o:OfficeDocumentSettings>\r\n    <o:AllowPNG/>\r\n    <o:PixelsPerInch>96</o:PixelsPerInch>\r\n    </o:OfficeDocumentSettings>\r\n    </xml>\r\n    <![endif]-->\r\n    <!--[if (gte mso 9)|(IE)]>\r\n    <style type=3D\"text/css\">\r\n      body {width: 600px;margin: 0 auto;}\r\n      table {border-collapse: collapse;}\r\n      table, td {mso-table-lspace: 0pt;mso-table-rspace: 0pt;}\r\n      img {-ms-interpolation-mode: bicubic;}\r\n    </style>\r\n    <![endif]-->\r\n\r\n    <style type=3D\"text/css\">\r\n      body, p, div {\r\n        font-family: arial;\r\n        font-size: 14px;\r\n      }\r\n      body {\r\n        color: #000000;\r\n      }\r\n      body a {\r\n        color: #1188E6;\r\n        text-decoration: none;\r\n      }\r\n      p { margin: 0; padding: 0; }\r\n      table.wrapper {\r\n        width:100% !important;\r\n        table-layout: fixed;\r\n        -webkit-font-smoothing: antialiased;\r\n        -webkit-text-size-adjust: 100%;\r\n        -moz-text-size-adjust: 100%;\r\n        -ms-text-size-adjust: 100%;\r\n      }\r\n      img.max-width {\r\n        max-width: 100% !important;\r\n      }\r\n      .column.of-2 {\r\n        width: 50%;\r\n      }\r\n      .column.of-3 {\r\n        width: 33.333%;\r\n      }\r\n      .column.of-4 {\r\n        width: 25%;\r\n      }\r\n      @media screen and (max-width:480px) {\r\n        .preheader .rightColumnContent,\r\n        .footer .rightColumnContent {\r\n            text-align: left !important;\r\n        }\r\n        .preheader .rightColumnContent div,\r\n        .preheader .rightColumnContent span,\r\n        .footer .rightColumnContent div,\r\n        .footer .rightColumnContent span {\r\n          text-align: left !important;\r\n        }\r\n        .preheader .rightColumnContent,\r\n        .preheader .leftColumnContent {\r\n          font-size: 80% !important;\r\n          padding: 5px 0;\r\n        }\r\n        table.wrapper-mobile {\r\n          width: 100% !important;\r\n          table-layout: fixed;\r\n        }\r\n        img.max-width {\r\n          height: auto !important;\r\n          max-width: 480px !important;\r\n        }\r\n        a.bulletproof-button {\r\n          display: block !important;\r\n          width: auto !important;\r\n          font-size: 80%;\r\n          padding-left: 0 !important;\r\n          padding-right: 0 !important;\r\n        }\r\n        .columns {\r\n          width: 100% !important;\r\n        }\r\n        .column {\r\n          display: block !important;\r\n          width: 100% !important;\r\n          padding-left: 0 !important;\r\n          padding-right: 0 !important;\r\n          margin-left: 0 !important;\r\n          margin-right: 0 !important;\r\n        }\r\n      }\r\n    </style>\r\n    <!--user entered Head Start-->\r\n=20=20=20=20\r\n     <!--End Head user entered-->\r\n  </head>\r\n  <body>\r\n    <center class=3D\"wrapper\" data-link-color=3D\"#1188E6\" data-body-style=\r\n=3D\"font-size: 14px; font-family: arial; color: #000000; background-color: =\r\n#ffffff;\">\r\n      <div class=3D\"webkit\">\r\n        <table cellpadding=3D\"0\" cellspacing=3D\"0\" border=3D\"0\" width=3D\"10=\r\n0%\" class=3D\"wrapper\" bgcolor=3D\"#ffffff\">\r\n          <tr>\r\n            <td valign=3D\"top\" bgcolor=3D\"#ffffff\" width=3D\"100%\">\r\n              <table width=3D\"100%\" role=3D\"content-container\" class=3D\"out=\r\ner\" align=3D\"center\" cellpadding=3D\"0\" cellspacing=3D\"0\" border=3D\"0\">\r\n                <tr>\r\n                  <td width=3D\"100%\">\r\n                    <table width=3D\"100%\" cellpadding=3D\"0\" cellspacing=3D\"=\r\n0\" border=3D\"0\">\r\n                      <tr>\r\n                        <td>\r\n                          <!--[if mso]>\r\n                          <center>\r\n                          <table><tr><td width=3D\"600\">\r\n                          <![endif]-->\r\n                          <table width=3D\"100%\" cellpadding=3D\"0\" cellspaci=\r\nng=3D\"0\" border=3D\"0\" style=3D\"width: 100%; max-width:600px;\" align=3D\"cent=\r\ner\">\r\n                            <tr>\r\n                              <td role=3D\"modules-container\" style=3D\"paddi=\r\nng: 0px 0px 0px 0px; color: #000000; text-align: left;\" bgcolor=3D\"#ffffff\"=\r\n width=3D\"100%\" align=3D\"left\">\r\n=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=\r\n=20=20=20=20=20=20=20\r\n    <table class=3D\"module preheader preheader-hide\" role=3D\"module\" data-t=\r\nype=3D\"preheader\" border=3D\"0\" cellpadding=3D\"0\" cellspacing=3D\"0\" width=3D=\r\n\"100%\"\r\n           style=3D\"display: none !important; mso-hide: all; visibility: hi=\r\ndden; opacity: 0; color: transparent; height: 0; width: 0;\">\r\n      <tr>\r\n        <td role=3D\"module-content\">\r\n          <p>If you don't click this link, you receive no AWS snark.</p>\r\n        </td>\r\n      </tr>\r\n    </table>\r\n=20=20\r\n    <table class=3D\"module\" role=3D\"module\" data-type=3D\"text\" border=3D\"0\"=\r\n cellpadding=3D\"0\" cellspacing=3D\"0\" width=3D\"100%\" style=3D\"table-layout: =\r\nfixed;\">\r\n      <tr>\r\n        <td style=3D\"padding:18px 0px 18px 0px;line-height:22px;text-align:=\r\ninherit;\"\r\n            height=3D\"100%\"\r\n            valign=3D\"top\"\r\n            bgcolor=3D\"\">\r\n            <div><span style=3D\"caret-color: rgb(34, 34, 34); color: rgb(34=\r\n, 34, 34); font-family: &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-=\r\nserif; font-size: 14px; font-style: normal; font-variant-caps: normal; font=\r\n-weight: normal; text-size-adjust: auto;\">Please confirm your Last Week in =\r\nAWS subscription by clicking the link below:</span><br style=3D\"caret-color=\r\n: rgb(34, 34, 34); color: rgb(34, 34, 34); text-size-adjust: auto; font-fam=\r\nily: &quot;Helvetica Neue&quot;, Helvetica, Helvetica, Arial, sans-serif; l=\r\nine-height: 1.5;\">\r\n<br style=3D\"caret-color: rgb(34, 34, 34); color: rgb(34, 34, 34); text-siz=\r\ne-adjust: auto; font-family: &quot;Helvetica Neue&quot;, Helvetica, Helveti=\r\nca, Arial, sans-serif; line-height: 1.5;\">\r\n&nbsp;</div>\r\n        </td>\r\n      </tr>\r\n    </table>\r\n  <table border=3D\"0\" cellPadding=3D\"0\" cellSpacing=3D\"0\" class=3D\"module\" =\r\ndata-role=3D\"module-button\" data-type=3D\"button\" role=3D\"module\" style=3D\"t=\r\nable-layout:fixed\" width=3D\"100%\"><tbody><tr><td align=3D\"center\" class=3D\"=\r\nouter-td\" style=3D\"padding:0px 0px 0px 0px\"><table border=3D\"0\" cellPadding=\r\n=3D\"0\" cellSpacing=3D\"0\" class=3D\"button-css__deep-table___2OZyb wrapper-mo=\r\nbile\" style=3D\"text-align:center\"><tbody><tr><td align=3D\"center\" bgcolor=\r\n=3D\"#f2cd00\" class=3D\"inner-td\" style=3D\"border-radius:6px;font-size:16px;t=\r\next-align:center;background-color:inherit\"><a style=3D\"background-color:#f2=\r\ncd00;border:1px solid #333333;border-color:#333333;border-radius:6px;border=\r\n-width:1px;color:#000000;display:inline-block;font-family:verdana,geneva,sa=\r\nns-serif;font-size:16px;font-weight:normal;letter-spacing:0px;line-height:1=\r\n6px;padding:12px 18px 12px 18px;text-align:center;text-decoration:none\" hre=\r\nf=3D\"https://links.lastweekinaws.com/wf/click?upn=3DhvM7RXoxZ2y0sN3anKzguOd=\r\npVZrLMJgbSh0oE9rIUt0cM07-2B2Kpc-2BNROmlCNnoPUwPeUDLDCV-2Be8x9IJ6vMToWAOHPQa=\r\nfvUkiDNQINpcuDlOEIA73rCT22njakO9cttebajyeBMhIV93A4zF89Xrbff50-2BRtPxYzfOpzF=\r\nzFQC15XjED4INEgj3gfx0h0dumhKncUJyOuHbMHbR7jPFH-2F0gYROR2XsN8Ic9oNXt7Zs-2BM-=\r\n2BM4t16g352jxogwpmwFgOFAF-2Fymdq-2FkI2zbKugAsdWL3TKVbnvmEt26HgVPALu5WFjVbbY=\r\nrf-2FCTARekcrY4qwFlkaZvUlEYMwr6HtEeCEWV6z8LT3z5JChfuI2OiGQy5VdFTRXKx-2BQ0u5=\r\nqQzKH-2FUPJgYdYsW-2BlkxvFCcI-2Br6-2Bu-2Fie-2FUs2ns82WFoYfxnCyzkZ-2BUSrOD64n=\r\njngl7PMUCW06QiKCQdDyMzm9d1lyBFHbACPxSHF-2FMonoO6KFVU4X1RkqjT9qWKWksBdR8jedJ=\r\nqyZQtnFxR845hVGK-2BZkjz6lQ-3D-3D_XwUfvOvxkJcP-2B2a1h27S5NuILQl2Kg6kQrqw-2BR=\r\nLhkGIPetytAm-2BOmv8MLHrP4d0EiC2-2F0qoc4D1el4IDuUPz4yhA3UVGcrn3wYC1zJ-2Bnmf5=\r\nfcYLdb5wplpgI7E9eVoj08SSrZS8f0Uu38Q-2BQdzTmqfNOR16sIXRo-2B9RiYbNP05icnOkql8=\r\nvsiWdMQ3EDtsxJrTqs17vKvFlvG8jZRaTfqU19mrCG-2BonQoinoB79PIFA-3D\" target=3D\"_=\r\nblank\">Confirm Subscription</a></td></tr></tbody></table></td></tr></tbody>=\r\n</table>\r\n    <table class=3D\"module\" role=3D\"module\" data-type=3D\"text\" border=3D\"0\"=\r\n cellpadding=3D\"0\" cellspacing=3D\"0\" width=3D\"100%\" style=3D\"table-layout: =\r\nfixed;\">\r\n      <tr>\r\n        <td style=3D\"padding:18px 0px 18px 0px;line-height:22px;text-align:=\r\ninherit;\"\r\n            height=3D\"100%\"\r\n            valign=3D\"top\"\r\n            bgcolor=3D\"\">\r\n            <div><span style=3D\"color: rgb(34, 34, 34); font-family: &quot;=\r\nHelvetica Neue&quot;, Helvetica, Arial, sans-serif; font-size: 14px; font-s=\r\ntyle: normal; font-variant-ligatures: normal; font-variant-caps: normal; fo=\r\nnt-weight: 400; caret-color: rgb(34, 34, 34);\">If you don't want to subscri=\r\nbe, please ignore this email.</span></div>\r\n        </td>\r\n      </tr>\r\n    </table>\r\n=20=20\r\n                              </td>\r\n                            </tr>\r\n                          </table>\r\n                          <!--[if mso]>\r\n                          </td></tr></table>\r\n                          </center>\r\n                          <![endif]-->\r\n                        </td>\r\n                      </tr>\r\n                    </table>\r\n                  </td>\r\n                </tr>\r\n              </table>\r\n            </td>\r\n          </tr>\r\n        </table>\r\n      </div>\r\n    </center>\r\n=20=20\r\n<p>&nbsp;</p>\r\n\r\n<hr />\r\n<p>To make sure you keep getting these emails, please add corey@lastweekina=\r\nws.com to your address book or whitelist us. Want out of the loop? <a href=\r\n=3D\"https://links.lastweekinaws.com/wf/unsubscribe?upn=3DXwUfvOvxkJcP-2B2a1=\r\nh27S5NuILQl2Kg6kQrqw-2BRLhkGIPetytAm-2BOmv8MLHrP4d0EiC2-2F0qoc4D1el4IDuUPz4=\r\n102-2Bc9-2FpJSnecexXMk1pUn948KYttfiaeEHcGCkhPoNO-2FZG4VpfbO5V7Cu8l344y5XnCM=\r\nPx74LBv4CfmAXD0CXSrk7O0DPSSUCy-2B3DMfip-2FYPbsQftypMPLdsG0gwtCgL1cuA4WVq-2B=\r\n1bllSMyGcM5I-3D\">Click here</a> to tell me to leave you alone. My postal ad=\r\ndress: 1728 Ocean Ave #307, San Francisco, CA 94112</p>\r\n\r\n<img src=3D\"https://links.lastweekinaws.com/wf/open?upn=3DXwUfvOvxkJcP-2B2a=\r\n1h27S5NuILQl2Kg6kQrqw-2BRLhkGIPetytAm-2BOmv8MLHrP4d0EiC2-2F0qoc4D1el4IDuUPz=\r\n4xei1d-2BSMI0rpKUUbTsC8T775eckuNXnVbrTJ5nVNnIkv4A82dovn1MdZvWmNB8e1OUSL-2FG=\r\nLoMHae654cakQeKFvjxlN7ghNmPDmrTlNsDj1XZHZMp7POLZ0rgtlW3G6On5mCQzgwAJVB9XgeM=\r\n-2Fr0Xw-3D\" alt=3D\"\" width=3D\"1\" height=3D\"1\" border=3D\"0\" style=3D\"height:=\r\n1px !important;width:1px !important;border-width:0 !important;margin-top:0 =\r\n!important;margin-bottom:0 !important;margin-right:0 !important;margin-left=\r\n:0 !important;padding-top:0 !important;padding-bottom:0 !important;padding-=\r\nright:0 !important;padding-left:0 !important;\"/>\r\n</body>\r\n</html>\r\n\r\n--482ea0e4fea72a1e6563394d91f0759756646a8aaf95e798b65917980f4e--\r\n"
//    val expectedRequest = """{"to":["bar@bar.com"],"from":"foobar@mailer.opsdeploy.com","subject":"Please confirm your subscription to Last Week in AWS","body":"Return-Path: foobar@mailer.opsdeploy.com\r\nReceived: from o1.email.lastweekinaws.com (o1.email.lastweekinaws.com [167.89.87.215])\r\n by inbound-smtp.us-east-1.amazonaws.com with SMTP id qig1onhvj02tunba33p9g6ul96kf2ok4kunjq0o1\r\n for foobar@mailer.opsdeploy.com;\r\n Thu, 09 Aug 2018 00:54:08 +0000 (UTC)\r\nX-SES-Spam-Verdict: PASS\r\nX-SES-Virus-Verdict: PASS\r\nReceived-SPF: pass (spfCheck: domain of em2401.lastweekinaws.com designates 167.89.87.215 as permitted sender) client-ip=167.89.87.215; envelope-from=bounces+7617708-766b-foobar=mailer.opsdeploy.com@em2401.lastweekinaws.com; helo=o1.email.lastweekinaws.com;\r\nAuthentication-Results: amazonses.com;\r\n spf=pass (spfCheck: domain of em2401.lastweekinaws.com designates 167.89.87.215 as permitted sender) client-ip=167.89.87.215; envelope-from=bounces+7617708-766b-foobar=mailer.opsdeploy.com@em2401.lastweekinaws.com; helo=o1.email.lastweekinaws.com;\r\n dkim=pass header.i=@lastweekinaws.com;\r\nX-SES-RECEIPT: AEFBQUFBQUFBQUFIT3FLb2hNR09CZmhyU3J3Z3poL0ZxR3M1YitQeFByOEFta1IzZ0tjRkZnL0kzbzJ6L1dZOHpaTno5R0prQ2xjOW9LZElTQWxnRi9LdXlLN0xURXFIeXVaVG1VeVdMSTV1cDFhcTRyL0VPRDI4UWIwS2ZzSU5kMGRBVU9EU09HRENsSDhTK25hZEFBeEpvcGQwOEtKTlpZbjdDYmxtaCtIWWRGSXpBMktyRVJwSmtsQnQ1NU53MmZNNjNkUzgvYktwenhlUmVaZFdnc1lEZlkrRWxPQWJjOTBYUWhLbWtIUEhRdHFsNEtrZU10MWNyU29ZcitQWXhwemF4Qnl1ZGhBc1B4RWRjTXN0SmtHMUpJT3Q2eHF1VXJtT0lKbzI1NFRQUko3b3JwOCtnQlJkOUN3WmlNZGc4bkpRMVo1Y2tzVFpUMFpQNmZZYjlFTXhXTXorbUlKS3gwT0RSdFdwS3d5NHlFbU5pNlRzZ2tnPT0=\r\nReceived: by filter0080p3mdw1.sendgrid.net with SMTP id filter0080p3mdw1-16807-5B6B90B0-1A\r\n        2018-08-09 00:54:08.372433409 +0000 UTC m=+102000.921312404\r\nReceived: from NzYxNzcwOA (ec2-54-187-77-36.us-west-2.compute.amazonaws.com [54.187.77.36])\r\n\tby ismtpd0012p1las1.sendgrid.net (SG) with HTTP id D08eQjnLTVeSIpSO1JYmqw\r\n\tThu, 09 Aug 2018 00:54:08.333 +0000 (UTC)\r\nContent-Type: multipart/alternative; boundary=482ea0e4fea72a1e6563394d91f0759756646a8aaf95e798b65917980f4e\r\nDate: Thu, 09 Aug 2018 00:54:08 +0000 (UTC)\r\nFrom: foobar@mailer.opsdeploy.com\r\nMime-Version: 1.0\r\nTo: bar@bar.com\r\nMessage-ID: <D08eQjnLTVeSIpSO1JYmqw@ismtpd0012p1las1.sendgrid.net>\r\nSubject: Please confirm your subscription to Last Week in AWS\r\nX-SG-EID: 5DxuPoevWKYjBH+OE0L7SABM8d4rwiV2A634FFGX1dgVFkC4mzUCTLZbCsw6zgIvbia7/bzS0rV87T\r\n pMIadss6DvRv9GGlnlkctqv14rbXumV0dt8yhMiquCvQJ6x7bKQK7ElX12S1KqV+5xrfhWtenVeMc2\r\n YlEIdCOM1TYtooEWMbZM48x4f/aGLCP1JhU0g/jcsY1jhLJXBYMp0MYPj+A16tLFRlMcKbsPPxhoJj\r\n GARfgb9VLKOXnASyCd9ZMg\r\nList-Unsubscribe: <mailto:unsubscribe@em2401.lastweekinaws.com?subject=https://links.lastweekinaws.com/wf/unsubscribe*q*upn=XwUfvOvxkJcP-2B2a1h27S5NuILQl2Kg6kQrqw-2BRLhkGIPetytAm-2BOmv8MLHrP4d0EiC2-2F0qoc4D1el4IDuUPz4-2FsPvEaC7Qemci7RFWyQeF-2B9XLcc9NFqzmcayIMzQJFsUttO-2BabncfOfSEY8n4L-2Bec9YXn-2FcCuVZ8dmZ2Lbfh4PKdvvVYRl79oQ5vJV-2FUQXM7vXXUoeaXmSzpgmZU0PJR1CNMUfKg0LBxuH5BUhCIJs-3D>\r\nReply-To: Corey Quinn <corey@lastweekinaws.com>\r\nSender: foobar@mailer.opsdeploy.com\r\n\r\n--482ea0e4fea72a1e6563394d91f0759756646a8aaf95e798b65917980f4e\r\ncontent-transfer-encoding: quoted-printable\r\ncontent-type: text/plain; charset=\"UTF-8\"\r\nMime-Version: 1.0\r\n\r\nIf you don't click this link, you receive no AWS snark.\r\n\r\nwww.zombo.com https://links.lastweekinaws.com/wf/click?upn=3DjR4Up5cZVfSvR0=\r\nGQUjisNJiz3S-2BEhD8v3nweTma-2FeAaFhzheviEECOk8KyNNUMGqUcpVRS1AfzLGD4ZQsJbZ2=\r\n81oKMAvmGLxUKIHqGhY2tEI3UrbXYuuNHzwG59R9-2F6tOEGSP-2FuxjnqTLe5vCWXUDA-3D-3D=\r\n_XwUfvOvxkJcP-2B2a1h27S5NuILQl2Kg6kQrqw-2BRLhkGIPetytAm-2BOmv8MLHrP4d0EiC2-=\r\n2F0qoc4D1el4IDuUPz4-2BimtHxZvlB876AvPhmM05qd4nOupH-2FVsAT7gYmCmBm7NtmsWGggP=\r\nXgJDJhbT6DI8y4eE4u8g6Dhhvw0pjjXMqxPXtqizaBT5AUESXD-2B9hHq7M58RCO7JKVXBfEZMd=\r\nsr00apILiaspArTUqGkCLVQRs-3D\r\n\r\nPlease confirm your Last Week in AWS subscription by clicking the link belo=\r\nw:\r\n\r\nConfirm Subscription https://links.lastweekinaws.com/wf/click?upn=3DhvM7RXo=\r\nxZ2y0sN3anKzguOdpVZrLMJgbSh0oE9rIUt0cM07-2B2Kpc-2BNROmlCNnoPUwPeUDLDCV-2Be8=\r\nx9IJ6vMToWAOHPQafvUkiDNQINpcuDlOEIA73rCT22njakO9cttebajyeBMhIV93A4zF89Xrbff=\r\n50-2BRtPxYzfOpzFzFQC15XjED4INEgj3gfx0h0dumhKncUJyOuHbMHbR7jPFH-2F0gYROR2XsN=\r\n8Ic9oNXt7Zs-2BM-2BM4t16g352jxogwpmwFgOFAF-2Fymdq-2FkI2zbKugAsdWL3TKVbnvmEt2=\r\n6HgVPALu5WFjVbbYrf-2FCTARekcrY4qwFlkaZvUlEYMwr6HtEeCEWV6z8LT3z5JChfuI2OiGQy=\r\n5VdFTRXKx-2BQ0u5qQzKH-2FUPJgYdYsW-2BlkxvFCcI-2Br6-2Bu-2Fie-2FUs2ns82WFoYfxn=\r\nCyzkZ-2BUSrOD64njngl7PMUCW06QiKCQdDyMzm9d1lyBFHbACPxSHF-2FMonoO6KFVU4X1Rkqj=\r\nT9qWKWksBdR8jedJqyZQtnFxR845hVGK-2BZkjz6lQ-3D-3D_XwUfvOvxkJcP-2B2a1h27S5NuI=\r\nLQl2Kg6kQrqw-2BRLhkGIPetytAm-2BOmv8MLHrP4d0EiC2-2F0qoc4D1el4IDuUPz49RxIO-2B=\r\ncMXeyBQuvGZiLhDFquSLwbeOWedf2AUmiUloAe-2BTZx5ta-2FVk1fliPnNt0oJFt8KbWlx3lvY=\r\nVTCurog26waxQvzr-2F4aLEk68xsQUCWOgcs9f-2BvX9wldPo6DhuIHTNs4gEMWF4qZzeX-2BnP=\r\nmmfI-3D\r\n\r\nIf you don't want to subscribe, please ignore this email.To make sure you k=\r\neep getting these emails, please add corey@lastweekinaws.com to your addres=\r\ns book or whitelist us. Want out of the loop? https://links.lastweekinaws.c=\r\nom/wf/unsubscribe?upn=3DXwUfvOvxkJcP-2B2a1h27S5NuILQl2Kg6kQrqw-2BRLhkGIPety=\r\ntAm-2BOmv8MLHrP4d0EiC2-2F0qoc4D1el4IDuUPz44Ry1pDrFvBNQCeuEwFKuiBNE2RDVaPax8=\r\n7de3ujhdzoMXtK3DY9XNeKpOcGzwBLFf6iik-2Bsgg2Pyzq1ctS9dhqZdH7TifxZ1UuaUJ5vmT4=\r\n1VyY-2F2RD2VmARnnnME8wgxH4PEqHvR1fAivraS5pMwSo-3D=20\r\n\r\nMy postal address: 1728 Ocean Ave #307, San Francisco, CA 94112\r\n\r\n\r\n--482ea0e4fea72a1e6563394d91f0759756646a8aaf95e798b65917980f4e\r\ncontent-transfer-encoding: quoted-printable\r\ncontent-type: text/html; charset=\"UTF-8\"\r\nMime-Version: 1.0\r\n\r\n<!DOCTYPE html PUBLIC \"-//W3C//DTD XHTML 1.0 Strict//EN\" \"http://www.w3.org=\r\n/TR/xhtml1/DTD/xhtml1-strict.dtd\">\r\n<html data-editor-version=3D\"2\" class=3D\"sg-campaigns\" xmlns=3D\"http://www.=\r\nw3.org/1999/xhtml\">\r\n  <head>\r\n    <meta http-equiv=3D\"Content-Type\" content=3D\"text/html; charset=3Dutf-8=\r\n\" />\r\n    <meta name=3D\"viewport\" content=3D\"width=3Ddevice-width, initial-scale=\r\n=3D1, minimum-scale=3D1, maximum-scale=3D1\" /><!--[if !mso]><!-->\r\n    <meta http-equiv=3D\"X-UA-Compatible\" content=3D\"IE=3DEdge\" /><!--<![end=\r\nif]-->\r\n    <!--[if (gte mso 9)|(IE)]>\r\n    <xml>\r\n    <o:OfficeDocumentSettings>\r\n    <o:AllowPNG/>\r\n    <o:PixelsPerInch>96</o:PixelsPerInch>\r\n    </o:OfficeDocumentSettings>\r\n    </xml>\r\n    <![endif]-->\r\n    <!--[if (gte mso 9)|(IE)]>\r\n    <style type=3D\"text/css\">\r\n      body {width: 600px;margin: 0 auto;}\r\n      table {border-collapse: collapse;}\r\n      table, td {mso-table-lspace: 0pt;mso-table-rspace: 0pt;}\r\n      img {-ms-interpolation-mode: bicubic;}\r\n    </style>\r\n    <![endif]-->\r\n\r\n    <style type=3D\"text/css\">\r\n      body, p, div {\r\n        font-family: arial;\r\n        font-size: 14px;\r\n      }\r\n      body {\r\n        color: #000000;\r\n      }\r\n      body a {\r\n        color: #1188E6;\r\n        text-decoration: none;\r\n      }\r\n      p { margin: 0; padding: 0; }\r\n      table.wrapper {\r\n        width:100% !important;\r\n        table-layout: fixed;\r\n        -webkit-font-smoothing: antialiased;\r\n        -webkit-text-size-adjust: 100%;\r\n        -moz-text-size-adjust: 100%;\r\n        -ms-text-size-adjust: 100%;\r\n      }\r\n      img.max-width {\r\n        max-width: 100% !important;\r\n      }\r\n      .column.of-2 {\r\n        width: 50%;\r\n      }\r\n      .column.of-3 {\r\n        width: 33.333%;\r\n      }\r\n      .column.of-4 {\r\n        width: 25%;\r\n      }\r\n      @media screen and (max-width:480px) {\r\n        .preheader .rightColumnContent,\r\n        .footer .rightColumnContent {\r\n            text-align: left !important;\r\n        }\r\n        .preheader .rightColumnContent div,\r\n        .preheader .rightColumnContent span,\r\n        .footer .rightColumnContent div,\r\n        .footer .rightColumnContent span {\r\n          text-align: left !important;\r\n        }\r\n        .preheader .rightColumnContent,\r\n        .preheader .leftColumnContent {\r\n          font-size: 80% !important;\r\n          padding: 5px 0;\r\n        }\r\n        table.wrapper-mobile {\r\n          width: 100% !important;\r\n          table-layout: fixed;\r\n        }\r\n        img.max-width {\r\n          height: auto !important;\r\n          max-width: 480px !important;\r\n        }\r\n        a.bulletproof-button {\r\n          display: block !important;\r\n          width: auto !important;\r\n          font-size: 80%;\r\n          padding-left: 0 !important;\r\n          padding-right: 0 !important;\r\n        }\r\n        .columns {\r\n          width: 100% !important;\r\n        }\r\n        .column {\r\n          display: block !important;\r\n          width: 100% !important;\r\n          padding-left: 0 !important;\r\n          padding-right: 0 !important;\r\n          margin-left: 0 !important;\r\n          margin-right: 0 !important;\r\n        }\r\n      }\r\n    </style>\r\n    <!--user entered Head Start-->\r\n=20=20=20=20\r\n     <!--End Head user entered-->\r\n  </head>\r\n  <body>\r\n    <center class=3D\"wrapper\" data-link-color=3D\"#1188E6\" data-body-style=\r\n=3D\"font-size: 14px; font-family: arial; color: #000000; background-color: =\r\n#ffffff;\">\r\n      <div class=3D\"webkit\">\r\n        <table cellpadding=3D\"0\" cellspacing=3D\"0\" border=3D\"0\" width=3D\"10=\r\n0%\" class=3D\"wrapper\" bgcolor=3D\"#ffffff\">\r\n          <tr>\r\n            <td valign=3D\"top\" bgcolor=3D\"#ffffff\" width=3D\"100%\">\r\n              <table width=3D\"100%\" role=3D\"content-container\" class=3D\"out=\r\ner\" align=3D\"center\" cellpadding=3D\"0\" cellspacing=3D\"0\" border=3D\"0\">\r\n                <tr>\r\n                  <td width=3D\"100%\">\r\n                    <table width=3D\"100%\" cellpadding=3D\"0\" cellspacing=3D\"=\r\n0\" border=3D\"0\">\r\n                      <tr>\r\n                        <td>\r\n                          <!--[if mso]>\r\n                          <center>\r\n                          <table><tr><td width=3D\"600\">\r\n                          <![endif]-->\r\n                          <table width=3D\"100%\" cellpadding=3D\"0\" cellspaci=\r\nng=3D\"0\" border=3D\"0\" style=3D\"width: 100%; max-width:600px;\" align=3D\"cent=\r\ner\">\r\n                            <tr>\r\n                              <td role=3D\"modules-container\" style=3D\"paddi=\r\nng: 0px 0px 0px 0px; color: #000000; text-align: left;\" bgcolor=3D\"#ffffff\"=\r\n width=3D\"100%\" align=3D\"left\">\r\n=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=20=\r\n=20=20=20=20=20=20=20\r\n    <table class=3D\"module preheader preheader-hide\" role=3D\"module\" data-t=\r\nype=3D\"preheader\" border=3D\"0\" cellpadding=3D\"0\" cellspacing=3D\"0\" width=3D=\r\n\"100%\"\r\n           style=3D\"display: none !important; mso-hide: all; visibility: hi=\r\ndden; opacity: 0; color: transparent; height: 0; width: 0;\">\r\n      <tr>\r\n        <td role=3D\"module-content\">\r\n          <p>If you don't click this link, you receive no AWS snark.</p>\r\n        </td>\r\n      </tr>\r\n    </table>\r\n=20=20\r\n    <table class=3D\"module\" role=3D\"module\" data-type=3D\"text\" border=3D\"0\"=\r\n cellpadding=3D\"0\" cellspacing=3D\"0\" width=3D\"100%\" style=3D\"table-layout: =\r\nfixed;\">\r\n      <tr>\r\n        <td style=3D\"padding:18px 0px 18px 0px;line-height:22px;text-align:=\r\ninherit;\"\r\n            height=3D\"100%\"\r\n            valign=3D\"top\"\r\n            bgcolor=3D\"\">\r\n            <div><span style=3D\"caret-color: rgb(34, 34, 34); color: rgb(34=\r\n, 34, 34); font-family: &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-=\r\nserif; font-size: 14px; font-style: normal; font-variant-caps: normal; font=\r\n-weight: normal; text-size-adjust: auto;\">Please confirm your Last Week in =\r\nAWS subscription by clicking the link below:</span><br style=3D\"caret-color=\r\n: rgb(34, 34, 34); color: rgb(34, 34, 34); text-size-adjust: auto; font-fam=\r\nily: &quot;Helvetica Neue&quot;, Helvetica, Helvetica, Arial, sans-serif; l=\r\nine-height: 1.5;\">\r\n<br style=3D\"caret-color: rgb(34, 34, 34); color: rgb(34, 34, 34); text-siz=\r\ne-adjust: auto; font-family: &quot;Helvetica Neue&quot;, Helvetica, Helveti=\r\nca, Arial, sans-serif; line-height: 1.5;\">\r\n&nbsp;</div>\r\n        </td>\r\n      </tr>\r\n    </table>\r\n  <table border=3D\"0\" cellPadding=3D\"0\" cellSpacing=3D\"0\" class=3D\"module\" =\r\ndata-role=3D\"module-button\" data-type=3D\"button\" role=3D\"module\" style=3D\"t=\r\nable-layout:fixed\" width=3D\"100%\"><tbody><tr><td align=3D\"center\" class=3D\"=\r\nouter-td\" style=3D\"padding:0px 0px 0px 0px\"><table border=3D\"0\" cellPadding=\r\n=3D\"0\" cellSpacing=3D\"0\" class=3D\"button-css__deep-table___2OZyb wrapper-mo=\r\nbile\" style=3D\"text-align:center\"><tbody><tr><td align=3D\"center\" bgcolor=\r\n=3D\"#f2cd00\" class=3D\"inner-td\" style=3D\"border-radius:6px;font-size:16px;t=\r\next-align:center;background-color:inherit\"><a style=3D\"background-color:#f2=\r\ncd00;border:1px solid #333333;border-color:#333333;border-radius:6px;border=\r\n-width:1px;color:#000000;display:inline-block;font-family:verdana,geneva,sa=\r\nns-serif;font-size:16px;font-weight:normal;letter-spacing:0px;line-height:1=\r\n6px;padding:12px 18px 12px 18px;text-align:center;text-decoration:none\" hre=\r\nf=3D\"https://links.lastweekinaws.com/wf/click?upn=3DhvM7RXoxZ2y0sN3anKzguOd=\r\npVZrLMJgbSh0oE9rIUt0cM07-2B2Kpc-2BNROmlCNnoPUwPeUDLDCV-2Be8x9IJ6vMToWAOHPQa=\r\nfvUkiDNQINpcuDlOEIA73rCT22njakO9cttebajyeBMhIV93A4zF89Xrbff50-2BRtPxYzfOpzF=\r\nzFQC15XjED4INEgj3gfx0h0dumhKncUJyOuHbMHbR7jPFH-2F0gYROR2XsN8Ic9oNXt7Zs-2BM-=\r\n2BM4t16g352jxogwpmwFgOFAF-2Fymdq-2FkI2zbKugAsdWL3TKVbnvmEt26HgVPALu5WFjVbbY=\r\nrf-2FCTARekcrY4qwFlkaZvUlEYMwr6HtEeCEWV6z8LT3z5JChfuI2OiGQy5VdFTRXKx-2BQ0u5=\r\nqQzKH-2FUPJgYdYsW-2BlkxvFCcI-2Br6-2Bu-2Fie-2FUs2ns82WFoYfxnCyzkZ-2BUSrOD64n=\r\njngl7PMUCW06QiKCQdDyMzm9d1lyBFHbACPxSHF-2FMonoO6KFVU4X1RkqjT9qWKWksBdR8jedJ=\r\nqyZQtnFxR845hVGK-2BZkjz6lQ-3D-3D_XwUfvOvxkJcP-2B2a1h27S5NuILQl2Kg6kQrqw-2BR=\r\nLhkGIPetytAm-2BOmv8MLHrP4d0EiC2-2F0qoc4D1el4IDuUPz4yhA3UVGcrn3wYC1zJ-2Bnmf5=\r\nfcYLdb5wplpgI7E9eVoj08SSrZS8f0Uu38Q-2BQdzTmqfNOR16sIXRo-2B9RiYbNP05icnOkql8=\r\nvsiWdMQ3EDtsxJrTqs17vKvFlvG8jZRaTfqU19mrCG-2BonQoinoB79PIFA-3D\" target=3D\"_=\r\nblank\">Confirm Subscription</a></td></tr></tbody></table></td></tr></tbody>=\r\n</table>\r\n    <table class=3D\"module\" role=3D\"module\" data-type=3D\"text\" border=3D\"0\"=\r\n cellpadding=3D\"0\" cellspacing=3D\"0\" width=3D\"100%\" style=3D\"table-layout: =\r\nfixed;\">\r\n      <tr>\r\n        <td style=3D\"padding:18px 0px 18px 0px;line-height:22px;text-align:=\r\ninherit;\"\r\n            height=3D\"100%\"\r\n            valign=3D\"top\"\r\n            bgcolor=3D\"\">\r\n            <div><span style=3D\"color: rgb(34, 34, 34); font-family: &quot;=\r\nHelvetica Neue&quot;, Helvetica, Arial, sans-serif; font-size: 14px; font-s=\r\ntyle: normal; font-variant-ligatures: normal; font-variant-caps: normal; fo=\r\nnt-weight: 400; caret-color: rgb(34, 34, 34);\">If you don't want to subscri=\r\nbe, please ignore this email.</span></div>\r\n        </td>\r\n      </tr>\r\n    </table>\r\n=20=20\r\n                              </td>\r\n                            </tr>\r\n                          </table>\r\n                          <!--[if mso]>\r\n                          </td></tr></table>\r\n                          </center>\r\n                          <![endif]-->\r\n                        </td>\r\n                      </tr>\r\n                    </table>\r\n                  </td>\r\n                </tr>\r\n              </table>\r\n            </td>\r\n          </tr>\r\n        </table>\r\n      </div>\r\n    </center>\r\n=20=20\r\n<p>&nbsp;</p>\r\n\r\n<hr />\r\n<p>To make sure you keep getting these emails, please add corey@lastweekina=\r\nws.com to your address book or whitelist us. Want out of the loop? <a href=\r\n=3D\"https://links.lastweekinaws.com/wf/unsubscribe?upn=3DXwUfvOvxkJcP-2B2a1=\r\nh27S5NuILQl2Kg6kQrqw-2BRLhkGIPetytAm-2BOmv8MLHrP4d0EiC2-2F0qoc4D1el4IDuUPz4=\r\n102-2Bc9-2FpJSnecexXMk1pUn948KYttfiaeEHcGCkhPoNO-2FZG4VpfbO5V7Cu8l344y5XnCM=\r\nPx74LBv4CfmAXD0CXSrk7O0DPSSUCy-2B3DMfip-2FYPbsQftypMPLdsG0gwtCgL1cuA4WVq-2B=\r\n1bllSMyGcM5I-3D\">Click here</a> to tell me to leave you alone. My postal ad=\r\ndress: 1728 Ocean Ave #307, San Francisco, CA 94112</p>\r\n\r\n<img src=3D\"https://links.lastweekinaws.com/wf/open?upn=3DXwUfvOvxkJcP-2B2a=\r\n1h27S5NuILQl2Kg6kQrqw-2BRLhkGIPetytAm-2BOmv8MLHrP4d0EiC2-2F0qoc4D1el4IDuUPz=\r\n4xei1d-2BSMI0rpKUUbTsC8T775eckuNXnVbrTJ5nVNnIkv4A82dovn1MdZvWmNB8e1OUSL-2FG=\r\nLoMHae654cakQeKFvjxlN7ghNmPDmrTlNsDj1XZHZMp7POLZ0rgtlW3G6On5mCQzgwAJVB9XgeM=\r\n-2Fr0Xw-3D\" alt=3D\"\" width=3D\"1\" height=3D\"1\" border=3D\"0\" style=3D\"height:=\r\n1px !important;width:1px !important;border-width:0 !important;margin-top:0 =\r\n!important;margin-bottom:0 !important;margin-right:0 !important;margin-left=\r\n:0 !important;padding-top:0 !important;padding-bottom:0 !important;padding-=\r\nright:0 !important;padding-left:0 !important;\"/>\r\n</body>\r\n</html>\r\n\r\n--482ea0e4fea72a1e6563394d91f0759756646a8aaf95e798b65917980f4e--\r\n","replyTo":"","raw":true}"""
//    val emailMapping = "foobar@mailer.opsdeploy.com=bar@bar.com"
//    val s3Mock = s3ClientMock(content)
//    val clientMock = mock[AmazonSNS]
//    (clientMock.publish(_: String, _: String)).expects("some_topic", expectedRequest)
//    val logic = new ForwarderLogic(snsClient = clientMock, mailerTopic = "some_topic", s3Mock, "bucket")
//
//    // Act - Assert
//    val sesMessage = message.jsonDecode[SesMessage](ForwarderLogic.fieldRenames)
//    logic.handleRequest(sesMessage, emailMapping)
//
//  }
//
//  "An Email with multiple destinations" should "send a single email to each address" in {
//
//    // Arrange
//    val message = """{"notificationType":"Received","mail":{"timestamp":"2018-08-07T20:05:07.491Z","source":"replyto@test.com","messageId":"key","destination":["foo@foo.com","baz@baz.com"],"headersTruncated":false,"headers":[{"name":"Return-Path","value":"<replyto@test.com>"},{"name":"Received","value":"from sonic302-31.consmr.mail.bf2.yahoo.com (sonic302-31.consmr.mail.bf2.yahoo.com [74.6.135.230]) by inbound-smtp.us-east-1.amazonaws.com with SMTP id peln35k65ghljnavl0m8hdlbq0omhsm7ti51g9g1 for foo@foo.com; Tue, 07 Aug 2018 20:05:07 +0000 (UTC)"},{"name":"Content-Length","value":"1711"}],"commonHeaders":{"returnPath":"replyto@test.com","from":["Juan Torres <replyto@test.com>"],"date":"Tue, 7 Aug 2018 20:01:06 +0000 (UTC)","to":["\"foo@foo.com\" <foo@foo.com>"],"messageId":"<176128054.3622731.1533672066691@mail.yahoo.com>","subject":"test all things"}},"receipt":{"timestamp":"2018-08-07T20:05:07.491Z","processingTimeMillis":406,"recipients":["foo@foo.com","baz@baz.com"],"spamVerdict":{"status":"PASS"},"virusVerdict":{"status":"PASS"},"spfVerdict":{"status":"PASS"},"dkimVerdict":{"status":"PROCESSING_FAILED"},"dmarcVerdict":{"status":"PASS"},"action":{"type":"SNS","functionArn":"arn:aws:sns:us-east-1:065150860170:dev-mail-forwarder","encoding":"UTF8"}}}"""
//    val content = "Return-Path: <replyto@test.com>\r\nReceived: from sonic302-31.consmr.mail.bf2.yahoo.com (sonic302-31.consmr.mail.bf2.yahoo.com [74.6.135.230])\r\n by inbound-smtp.us-east-1.amazonaws.com with SMTP id peln35k65ghljnavl0m8hdlbq0omhsm7ti51g9g1\r\n for foo@foo.com;\r\n Tue, 07 Aug 2018 20:05:07 +0000 (UTC)\r\nX-SES-Spam-Verdict: PASS\r\nX-SES-Virus-Verdict: PASS\r\nReceived-SPF: pass (spfCheck: domain of _spf.mail.yahoo.com designates 74.6.135.230 as permitted sender) client-ip=74.6.135.230; envelope-from=replyto@test.com; helo=sonic302-31.consmr.mail.bf2.yahoo.com;\r\nAuthentication-Results: amazonses.com;\r\n spf=pass (spfCheck: domain of _spf.mail.yahoo.com designates 74.6.135.230 as permitted sender) client-ip=74.6.135.230; envelope-from=replyto@test.com; helo=sonic302-31.consmr.mail.bf2.yahoo.com;\r\n dkim=permerror header.i=@ymail.com;\r\nFrom: Juan Torres <replyto@test.com>\r\nTo: \"foo@foo.com\" <foo@foo.com>\r\nMessage-ID: <176128054.3622731.1533672066691@mail.yahoo.com>\r\nSubject: test all things\r\nMIME-Version: 1.0\r\nContent-Type: multipart/alternative; \r\n\tboundary=\"----=_Part_3622730_1056715004.1533672066689\"\r\nReferences: <176128054.3622731.1533672066691.ref@mail.yahoo.com>\r\nX-Mailer: WebService/1.1.12206 YMailNorrin Mozilla/5.0 (Macintosh; Intel Mac OS X 10_13_6) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/68.0.3440.84 Safari/537.36\r\nContent-Length: 1711\r\n\r\n------=_Part_3622730_1056715004.1533672066689\r\nContent-Type: text/plain; charset=UTF-8\r\nContent-Transfer-Encoding: quoted-printable\r\n\r\nFooBarbazbax=C2=A0 =C2=A0=C2=A0\r\n\r\nHeading\r\nImage\r\n  Via =20\r\n"
//    val expectedRequest    = """{"to":["bar@bar.com"],"from":"foo@foo.com","subject":"test all things","body":"Return-Path: <replyto@test.com>\r\nReceived: from sonic302-31.consmr.mail.bf2.yahoo.com (sonic302-31.consmr.mail.bf2.yahoo.com [74.6.135.230])\r\n by inbound-smtp.us-east-1.amazonaws.com with SMTP id peln35k65ghljnavl0m8hdlbq0omhsm7ti51g9g1\r\n for foo@foo.com;\r\n Tue, 07 Aug 2018 20:05:07 +0000 (UTC)\r\nX-SES-Spam-Verdict: PASS\r\nX-SES-Virus-Verdict: PASS\r\nReceived-SPF: pass (spfCheck: domain of _spf.mail.yahoo.com designates 74.6.135.230 as permitted sender) client-ip=74.6.135.230; envelope-from=replyto@test.com; helo=sonic302-31.consmr.mail.bf2.yahoo.com;\r\nAuthentication-Results: amazonses.com;\r\n spf=pass (spfCheck: domain of _spf.mail.yahoo.com designates 74.6.135.230 as permitted sender) client-ip=74.6.135.230; envelope-from=replyto@test.com; helo=sonic302-31.consmr.mail.bf2.yahoo.com;\r\n dkim=permerror header.i=@ymail.com;\r\nFrom: foo@foo.com\r\nTo: bar@bar.com\r\nMessage-ID: <176128054.3622731.1533672066691@mail.yahoo.com>\r\nSubject: test all things\r\nMIME-Version: 1.0\r\nContent-Type: multipart/alternative; \r\n\tboundary=\"----=_Part_3622730_1056715004.1533672066689\"\r\nReferences: <176128054.3622731.1533672066691.ref@mail.yahoo.com>\r\nX-Mailer: WebService/1.1.12206 YMailNorrin Mozilla/5.0 (Macintosh; Intel Mac OS X 10_13_6) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/68.0.3440.84 Safari/537.36\r\nContent-Length: 1711\r\nReply-To: Juan Torres <replyto@test.com>\r\n\r\n------=_Part_3622730_1056715004.1533672066689\r\nContent-Type: text/plain; charset=UTF-8\r\nContent-Transfer-Encoding: quoted-printable\r\n\r\nFooBarbazbax=C2=A0 =C2=A0=C2=A0\r\n\r\nHeading\r\nImage\r\n  Via =20\r\n","replyTo":"","raw":true}"""
//    val emailMapping = "foo@foo.com=bar@bar.com&baz@baz.com=blah@blah.com"
//    val s3Mock = s3ClientMock(content)
//    val clientMock = mock[AmazonSNS]
//    (clientMock.publish(_: String, _: String)).expects(*, *).repeated(2).times
//    val logic = new ForwarderLogic(snsClient = clientMock, mailerTopic = "some_topic", s3Mock, "bucket")
//
//    // Act
//    val sesMessage = message.jsonDecode[SesMessage](ForwarderLogic.fieldRenames)
//
//    // Assert
//    logic.handleRequest(sesMessage, emailMapping)
//  }
//
//  def s3ClientMock(content: String): AmazonS3 = {
//    val s3Response = new S3Object
//    s3Response.setObjectContent(new ByteArrayInputStream(content.getBytes()))
//    val s3Mock = mock[AmazonS3]
//    (s3Mock.getObject(_: String, _: String)).expects("bucket", "key").once().returning(s3Response)
//    s3Mock
//  }
//}
